---
title: "builtinã‚’å®Ÿè£…ã™ã‚‹"
---
# ãƒ“ãƒ«ãƒˆã‚¤ãƒ³ã‚³ãƒãƒ³ãƒ‰ã¨ã¯
ãƒ“ãƒ«ãƒˆã‚¤ãƒ³ï¼ˆçµ„ã¿è¾¼ã¿ï¼‰ã‚³ãƒãƒ³ãƒ‰ã¨ã¯ã€‚ã€‚ã€‚

```sh
type cd
```
typeã¯builtinã ã‘ã§ãªãaliasã‹ã©ã†ã‹ã®åˆ¤æ–­ã‚‚ã—ã¦ãã‚Œã‚‹å„ªã‚Œã‚‚ã®ã ã€‚ã‚‚ã—å¤–éƒ¨ã‚³ãƒãƒ³ãƒ‰ã¨ã—ã¦ã®```cd```ã®ãƒ‘ã‚¹ãŒæ¬²ã—ã„å ´åˆã¯```which cd```ã‚’ä½¿ã†ã“ã¨ãŒã§ãã‚‹ã€‚

## pwd
```go :builtin/builtin.go
func pwd(words []string) int {
	cwd, err := os.Getwd()
	if err != nil {
		fmt.Fprintf(os.Stderr, "Error: pwd:%v\n", err)
		return 1
	}
	fmt.Println(cwd)
	return 0
}
```

## cd
```go :builtin/builtin.go
func cd(words []string) int {
	if len(words) != 1 {
		fmt.Fprintf(os.Stderr, "Error: cd: too many arguments\n")
		return 1
	}
	err := os.Chdir(words[0])
	if err != nil {
		fmt.Fprintf(os.Stderr, "Error: cd: %v\n", err)
		return 1
	}
	return 0
}
```


## exit
exitã¯å˜ã«```os.Exit```ã‚’å®Ÿè¡Œã™ã‚‹ã ã‘ã ã€‚ã§ã‚‚exitã™ã‚‹å‰ã«é–‹ã„ãŸã¾ã¾ã®ãƒ•ã‚¡ã‚¤ãƒ«ã‚„ã‚´ãƒ«ãƒ¼ãƒãƒ³ãŒãªã„ã‹ç¢ºèªã™ã‚‹ã®ã¯å¤§åˆ‡ã ã€‚ä»Šå›ã¯bashã®ã‚ˆã†ã«å¼•æ•°ã‚’å—ã‘ã¨ã£ã¦exitã™ã‚‹ã‚ˆã†ã«ã—ãŸã€‚ã‚‚ã—å¼•æ•°ãŒ2å€‹ä»¥ä¸Šãªã‚‰exitã¯å¤±æ•—ã™ã‚‹ã‚ˆã†ã«ãªã£ã¦ã„ã‚‹ã€‚
```go :builtin/builtin.go
func exit(words []string) int {
	if len(words) == 0 {
		os.Exit(0)
	}
	if len(words) != 1 {
		fmt.Fprintf(os.Stderr, "Error: exit: too many arguments\n")
		return 1
	}
	status, err := strconv.Atoi(words[0])
	if err != nil {
		fmt.Fprintf(os.Stderr, "Error: exit: %s: inumeric argument required\n", words[0])
		os.Exit(255)
	}
	os.Exit(status)
	return 0
}
```


# builtinã‹ã©ã†ã‹ã®åˆ¤æ–­


ä»Š```pwd```ã€```cd```ã€```exit```ã®ã‚ˆã†ã«ä½•æ°—ãªãé–¢æ•°ã‚’å‘½åã—ãŸã‘ã‚Œã©ã‚‚ã€exitã¯ã™ã§ã«```os.Exit```ã¨ã„ã†é–¢æ•°ãŒã‚ã‚‹ã®ã«ç´›ã‚‰ã‚ã—ããªã„ã ã‚ã†ã‹ï¼Ÿå®Ÿã¯Goè¨€èªã§ã¯å°æ–‡å­—ã‹ã‚‰å§‹ã¾ã‚‹é–¢æ•°ã‚„å¤‰æ•°ã¯ãã®æœ‰åŠ¹ãªã‚¹ã‚³ãƒ¼ãƒ—ã‚’ãã®ãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ã«é™å®šã™ã‚‹ã€‚ã ã‹ã‚‰ã‚€ã—ã‚çŸ­ã„åå‰ã®å¤‰æ•°ã‚„é–¢æ•°ã¯Goè¨€èªã«ãŠã„ã¦ã¯æ¨å¥¨ã•ã‚Œã¦ã„ã‚‹ã‚“ã ã€‚

ã“ã‚Œã‚‰ã®é–¢æ•°ã‚’å¤–ã«æŒã¡å‡ºã™ãŸã‚ã®ãƒ‡ã‚£ã‚¹ãƒ‘ãƒƒãƒãƒ£ãƒ¼ã‚’ä½œã‚ã†ã€‚æ¬²ã—ã„ã®ã¯ã‚³ãƒãƒ³ãƒ‰ãŒbuiltinã«ã‚ã‚‹ã‹ã©ã†ã‹åˆ¤æ–­ã™ã‚‹é–¢æ•°ã¨å®Ÿè¡Œã™ã‚‹é–¢æ•°ã®äºŒã¤ã ã€‚ã‚‚ã¡ã‚ã‚“ã“ã‚Œã‚‰ã®é–¢æ•°ã¯å¤§æ–‡å­—ã§å§‹ã‚ãªã‘ã‚Œã°ã„ã‘ãªã„ã€‚

```go :builtin/builtin.go

var builtins = map[string]func([]string) int{
	"pwd":  pwd,
	"cd":   cd,
	"exit": exit,
}

func LookupBuiltin(name string) bool {
	_, exists := builtins[name]
	return exists
}

func ExecBuiltin(name string, words []string) int {
	return builtins[name](words)
}
```


buitiné–¢æ•°ã¯å¤–éƒ¨é–¢æ•°ã‚ˆã‚Šã‚‚å„ªå…ˆçš„ã«å‡¦ç†ã•ã‚Œã‚‹ã¹ãã ã€‚ä»Šä½œã£ãŸé–¢æ•°ã‚’å…¥ã‚Œã¦ãŠã“ã†ã€‚
```go :simple_command.go
func ExecSimpleCommandSync(words []string) int {
    if builtin.LookupBuiltin(words[0]) {
    		return builtin.ExecBuiltin(words[0], words[1:], inputFile, outputFile)
    	}

    [...]
```




ã“ã‚Œã§ç§ãŸã¡ã®ã‚·ã‚§ãƒ«ã¯ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªã®ç§»å‹•ã‚„exitãŒã§ãã‚‹ã‚ˆã†ã«ãªã£ãŸã¯ãšã ã€‚
```sh
ğŸ $ pwd  
/Users/yui/GolandProjects/GO_SHELL/srcs
ğŸ $ cd ..
ğŸ $ pwd
/Users/yui/GolandProjects/GO_SHELL
ğŸ $ cd srcs/..////.///srcs/builtin
ğŸ $ pwd
/Users/yui/GolandProjects/GO_SHELL/srcs/builtin
ğŸ $ cd ~
Error: cd: chdir ~: no such file or directory
ğŸ $ cd -
Error: cd: chdir -: no such file or directory
ğŸ $ cd
Error: cd: too many arguments
ğŸ $ exit
```
